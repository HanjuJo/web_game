<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI ì»¤ì„œ ì¶”ì  ê²Œì„</title>
    <link rel="stylesheet" href="mobile-styles.css">
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
        }
        
        #game-container {
            position: relative;
            width: 100vw;
            height: 100vh;
        }
        
        .target {
            position: absolute;
            width: 40px;
            height: 40px;
            background-color: #ff6b6b;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .target:hover {
            background-color: #ff8787;
        }
        
        .ai-cursor {
            position: absolute;
            width: 20px;
            height: 20px;
            background-color: #4dabf7;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            pointer-events: none;
        }
        
        #score-container {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 18px;
            z-index: 100;
        }
        
        #timer {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 18px;
            z-index: 100;
        }
        
        #game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            z-index: 200;
            display: none;
        }
        
        #difficulty-select {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(255, 255, 255, 0.9);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            z-index: 200;
        }
        
        .difficulty-btn {
            background-color: #4dabf7;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            min-width: 150px;
        }
        
        .difficulty-btn:hover {
            background-color: #339af0;
        }
        
        #home-btn {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(255, 255, 255, 0.8);
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 16px;
            z-index: 100;
            cursor: pointer;
        }
        
        button {
            background-color: #4dabf7;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }
        
        button:hover {
            background-color: #339af0;
        }
        
        /* ë³´ìƒ ì•Œë¦¼ */
        .rewards-notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #fcc419;
            color: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: none;
            align-items: center;
            z-index: 300;
            animation: slideIn 0.5s forwards;
        }
        
        .rewards-icon {
            font-size: 24px;
            margin-right: 10px;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        @keyframes slideOut {
            from {
                transform: translateX(0);
                opacity: 1;
            }
            to {
                transform: translateX(100%);
                opacity: 0;
            }
        }
        
        .best-score {
            font-size: 16px;
            color: #495057;
            margin-top: 15px;
        }
        
        .new-record {
            color: #e67700;
            font-weight: bold;
        }
        
        @media (max-width: 768px) {
            .target {
                width: 50px;
                height: 50px;
            }
            
            #score-container, #timer {
                font-size: 16px;
                padding: 8px 15px;
            }
            
            #home-btn {
                font-size: 14px;
                padding: 8px 15px;
            }
            
            .difficulty-btn {
                min-width: 80%;
                margin: 8px auto;
                padding: 15px;
                display: block;
            }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="score-container">ì ìˆ˜: <span id="score">0</span></div>
        <div id="timer">ì‹œê°„: <span id="time">60</span>ì´ˆ</div>
        <div id="home-btn" onclick="window.location.href='index.html'">í™ˆìœ¼ë¡œ</div>
        <div class="ai-cursor" id="ai-cursor"></div>
    </div>
    
    <div id="difficulty-select">
        <h2>ë‚œì´ë„ ì„ íƒ</h2>
        <p>ë‚˜ì—ê²Œ ë§ëŠ” ë‚œì´ë„ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
        <button class="difficulty-btn" onclick="startGame('ì´ˆë“±í•™ìƒ')">ì´ˆë“±í•™ìƒ</button><br>
        <button class="difficulty-btn" onclick="startGame('ì¤‘í•™ìƒ')">ì¤‘í•™ìƒ</button><br>
        <button class="difficulty-btn" onclick="startGame('ê³ ë“±í•™ìƒ')">ê³ ë“±í•™ìƒ</button><br>
        <button class="difficulty-btn" onclick="startGame('ì„±ì¸')">ì„±ì¸</button>
    </div>
    
    <div id="game-over">
        <h2>ê²Œì„ ì¢…ë£Œ!</h2>
        <p>ìµœì¢… ì ìˆ˜: <span id="final-score">0</span></p>
        <div class="best-score">ìµœê³  ê¸°ë¡: <span id="best-score">0</span>ì </div>
        <button id="restart-button">ë‹¤ì‹œ ì‹œì‘</button>
        <button onclick="window.location.href='index.html'">ë©”ì¸ ë©”ë‰´ë¡œ</button>
        <button onclick="window.location.href='rewards.html'">ë³´ìƒ í™•ì¸</button>
    </div>
    
    <div class="rewards-notification" id="rewards-notification">
        <div class="rewards-icon">ğŸ†</div>
        <div class="rewards-text">ìƒˆë¡œìš´ ë³´ìƒì´ í•´ê¸ˆë˜ì—ˆìŠµë‹ˆë‹¤!</div>
    </div>

    <script>
        const gameContainer = document.getElementById('game-container');
        const scoreElement = document.getElementById('score');
        const timeElement = document.getElementById('time');
        const aiCursor = document.getElementById('ai-cursor');
        const gameOverScreen = document.getElementById('game-over');
        const finalScoreElement = document.getElementById('final-score');
        const bestScoreElement = document.getElementById('best-score');
        const restartButton = document.getElementById('restart-button');
        const difficultySelect = document.getElementById('difficulty-select');
        const rewardsNotification = document.getElementById('rewards-notification');
        
        let score = 0;
        let timeLeft = 60;
        let gameActive = false;
        let targets = [];
        let targetCounter = 1;
        let playerPosition = { x: 0, y: 0 };
        let aiPosition = { x: 0, y: 0 };
        let difficulty = null;
        let bestScore = 0;
        
        // ë‚œì´ë„ë³„ ì„¤ì •ê°’
        const difficultySettings = {
            'ì´ˆë“±í•™ìƒ': {
                targetSize: 50,
                gameTime: 90,
                aiFollowSpeed: 0.02,
                distractionChance: 0.003,
                targetAddScore: 70,
                pointsPerTarget: 5
            },
            'ì¤‘í•™ìƒ': {
                targetSize: 40,
                gameTime: 60,
                aiFollowSpeed: 0.03,
                distractionChance: 0.005,
                targetAddScore: 50,
                pointsPerTarget: 10
            },
            'ê³ ë“±í•™ìƒ': {
                targetSize: 30,
                gameTime: 45,
                aiFollowSpeed: 0.04,
                distractionChance: 0.007,
                targetAddScore: 40,
                pointsPerTarget: 15
            },
            'ì„±ì¸': {
                targetSize: 25,
                gameTime: 30,
                aiFollowSpeed: 0.05,
                distractionChance: 0.01,
                targetAddScore: 30,
                pointsPerTarget: 20
            }
        };
        
        // AI ì»¤ì„œì˜ í–‰ë™ íŠ¹ì„± (ê¸°ë³¸ê°’)
        const aiSettings = {
            followSpeed: 0.03,
            distractionChance: 0.005,
            maxDistraction: 3000,
            randomMovementRange: 100,
            randomMovementSpeed: 0.05
        };
        
        let currentDistraction = null;
        let distractionTimer = null;
        let gameTimer = null;
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìµœê³  ì ìˆ˜ ê°€ì ¸ì˜¤ê¸°
        document.addEventListener('DOMContentLoaded', () => {
            // ë³´ìƒ ì‹œìŠ¤í…œì´ ìˆëŠ”ì§€ í™•ì¸
            if (window.gameRewards) {
                bestScore = window.gameRewards.getBestScore('ai-cursor');
                bestScoreElement.textContent = bestScore;
            }
        });
        
        // ë‚œì´ë„ ì„ íƒ ë° ê²Œì„ ì‹œì‘
        function startGame(selectedDifficulty) {
            difficulty = selectedDifficulty;
            difficultySelect.style.display = 'none';
            
            // ë‚œì´ë„ì— ë”°ë¥¸ ì„¤ì • ì ìš©
            const settings = difficultySettings[difficulty];
            timeLeft = settings.gameTime;
            aiSettings.followSpeed = settings.aiFollowSpeed;
            aiSettings.distractionChance = settings.distractionChance;
            
            initGame();
        }
        
        // ê²Œì„ ì´ˆê¸°í™”
        function initGame() {
            const settings = difficultySettings[difficulty];
            
            score = 0;
            gameActive = true;
            scoreElement.textContent = score;
            timeElement.textContent = timeLeft;
            gameOverScreen.style.display = 'none';
            targets.forEach(target => target.remove());
            targets = [];
            targetCounter = 1;
            
            // ì²« íƒ€ê²Ÿ ìƒì„±
            createTarget();
            
            // íƒ€ì´ë¨¸ ì‹œì‘
            if (gameTimer) {
                clearInterval(gameTimer);
            }
            
            gameTimer = setInterval(() => {
                timeLeft--;
                timeElement.textContent = timeLeft;
                
                if (timeLeft <= 0) {
                    clearInterval(gameTimer);
                    endGame();
                }
            }, 1000);
        }
        
        // íƒ€ê²Ÿ ìƒì„±
        function createTarget() {
            if (!gameActive) return;
            
            const targetSize = difficultySettings[difficulty].targetSize;
            const target = document.createElement('div');
            target.className = 'target';
            target.style.width = targetSize + 'px';
            target.style.height = targetSize + 'px';
            target.innerText = targetCounter;
            
            // ëœë¤ ìœ„ì¹˜ (í™”ë©´ ê²½ê³„ì—ì„œ ì•½ê°„ ë–¨ì–´ì§„ ê³³)
            const margin = targetSize;
            const x = margin + Math.random() * (window.innerWidth - 2 * margin);
            const y = margin + Math.random() * (window.innerHeight - 2 * margin);
            
            target.style.left = x + 'px';
            target.style.top = y + 'px';
            
            // ëª¨ë°”ì¼ì—ì„œ í„°ì¹˜ ì´ë²¤íŠ¸ ì§€ì›
            target.addEventListener('click', () => targetClicked(target));
            target.addEventListener('touchstart', (e) => {
                e.preventDefault();
                targetClicked(target);
            }, { passive: false });
            
            gameContainer.appendChild(target);
            targets.push(target);
            targetCounter++;
            
            // ì¼ì • ì ìˆ˜ ê°„ê²©ìœ¼ë¡œ ìƒˆ íƒ€ê²Ÿ ìƒì„±
            if (score >= difficultySettings[difficulty].targetAddScore * (targetCounter - 2)) {
                setTimeout(createTarget, 500);
            }
        }
        
        // ë§ˆìš°ìŠ¤ ì´ë™ ì´ë²¤íŠ¸
        document.addEventListener('mousemove', (e) => {
            playerPosition.x = e.clientX;
            playerPosition.y = e.clientY;
        });
        
        // í„°ì¹˜ ì´ë²¤íŠ¸ ì§€ì› ì¶”ê°€
        document.addEventListener('touchmove', (e) => {
            e.preventDefault(); // ìŠ¤í¬ë¡¤ ë°©ì§€
            if (e.touches.length > 0) {
                const touch = e.touches[0];
                playerPosition.x = touch.clientX;
                playerPosition.y = touch.clientY;
            }
        }, { passive: false });
        
        // AI ì»¤ì„œ ì›€ì§ì„ ì—…ë°ì´íŠ¸
        function updateAiCursor() {
            if (!gameActive) {
                requestAnimationFrame(updateAiCursor);
                return;
            }
            
            let targetX, targetY;
            
            // AIê°€ í˜„ì¬ íŠ¹ì • íƒ€ê²Ÿì— ì§‘ì¤‘í•˜ê³  ìˆëŠ”ì§€ í™•ì¸
            if (currentDistraction) {
                const rect = currentDistraction.getBoundingClientRect();
                targetX = rect.left + rect.width / 2;
                targetY = rect.top + rect.height / 2;
            } 
            // ìƒˆë¡œìš´ ì§‘ì¤‘ ëŒ€ìƒì„ ì°¾ì„ í™•ë¥  ê³„ì‚°
            else if (targets.length > 0 && Math.random() < aiSettings.distractionChance) {
                // ëœë¤í•œ íƒ€ê²Ÿ ì„ íƒ
                currentDistraction = targets[Math.floor(Math.random() * targets.length)];
                const rect = currentDistraction.getBoundingClientRect();
                targetX = rect.left + rect.width / 2;
                targetY = rect.top + rect.height / 2;
                
                // ì¼ì • ì‹œê°„ í›„ ì§‘ì¤‘ í•´ì œ
                distractionTimer = setTimeout(() => {
                    currentDistraction = null;
                }, Math.random() * aiSettings.maxDistraction);
            } 
            // ê¸°ë³¸ì ìœ¼ë¡œ í”Œë ˆì´ì–´ ì»¤ì„œë¥¼ ë”°ë¼ê°
            else {
                targetX = playerPosition.x;
                targetY = playerPosition.y;
                
                // ì•½ê°„ì˜ ëœë¤í•œ ì›€ì§ì„ ì¶”ê°€
                if (Math.random() < 0.03) {
                    targetX += (Math.random() - 0.5) * aiSettings.randomMovementRange;
                    targetY += (Math.random() - 0.5) * aiSettings.randomMovementRange;
                }
            }
            
            // ë¶€ë“œëŸ¬ìš´ ì´ë™
            aiPosition.x += (targetX - aiPosition.x) * (currentDistraction ? aiSettings.randomMovementSpeed : aiSettings.followSpeed);
            aiPosition.y += (targetY - aiPosition.y) * (currentDistraction ? aiSettings.randomMovementSpeed : aiSettings.followSpeed);
            
            // AI ì»¤ì„œ ìœ„ì¹˜ ì—…ë°ì´íŠ¸
            aiCursor.style.left = `${aiPosition.x}px`;
            aiCursor.style.top = `${aiPosition.y}px`;
            
            requestAnimationFrame(updateAiCursor);
        }
        
        // íƒ€ê²Ÿ í´ë¦­ ì²˜ë¦¬ í•¨ìˆ˜
        function targetClicked(target) {
            if (!gameActive) return;
            
            const settings = difficultySettings[difficulty];
            score += settings.pointsPerTarget;
            scoreElement.textContent = score;
            target.remove();
            
            // íƒ€ê²Ÿ ë°°ì—´ì—ì„œ ì œê±°
            targets = targets.filter(t => t !== target);
            
            // AIê°€ íƒ€ê²Ÿì— ì§‘ì¤‘í•˜ê³  ìˆì—ˆë‹¤ë©´ ì§‘ì¤‘ í•´ì œ
            if (currentDistraction === target) {
                currentDistraction = null;
                clearTimeout(distractionTimer);
            }
            
            createTarget();
        }
        
        // ê²Œì„ ì¢…ë£Œ
        function endGame() {
            gameActive = false;
            finalScoreElement.textContent = score;
            
            // ìµœê³  ì ìˆ˜ í™•ì¸ ë° ì—…ë°ì´íŠ¸
            const isNewRecord = score > bestScore;
            if (isNewRecord) {
                bestScore = score;
                bestScoreElement.textContent = bestScore;
                bestScoreElement.classList.add('new-record');
            } else {
                bestScoreElement.classList.remove('new-record');
                bestScoreElement.textContent = bestScore;
            }
            
            // ë³´ìƒ ì‹œìŠ¤í…œì— ì ìˆ˜ ì—…ë°ì´íŠ¸
            if (window.gameRewards) {
                const newRewards = window.gameRewards.updateScore('ai-cursor', score);
                if (newRewards) {
                    showRewardsNotification();
                }
            }
            
            gameOverScreen.style.display = 'block';
        }
        
        // ë³´ìƒ ì•Œë¦¼ í‘œì‹œ
        function showRewardsNotification() {
            rewardsNotification.style.display = 'flex';
            rewardsNotification.style.animation = 'slideIn 0.5s forwards';
            
            setTimeout(() => {
                rewardsNotification.style.animation = 'slideOut 0.5s forwards';
                setTimeout(() => {
                    rewardsNotification.style.display = 'none';
                }, 500);
            }, 3000);
        }
        
        // ë‹¤ì‹œ ì‹œì‘ ë²„íŠ¼
        restartButton.addEventListener('click', () => {
            gameOverScreen.style.display = 'none';
            difficultySelect.style.display = 'block';
        });
        
        // ê²Œì„ ì‹œì‘
        window.addEventListener('load', () => {
            // ì´ˆê¸°ì—ëŠ” ë‚œì´ë„ ì„ íƒ í™”ë©´ë§Œ í‘œì‹œ
            gameOverScreen.style.display = 'none';
            difficultySelect.style.display = 'block';
            updateAiCursor();
        });
    </script>
</body>
</html> 